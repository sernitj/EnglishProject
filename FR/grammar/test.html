<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>The Carroll Project</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" type="text/css" href="css/test.css">
  <link rel="stylesheet" type="text/css" href="css/buttons.css">
  <link rel="stylesheet" type="text/css" href="css/checkbox.css">
  <link rel="stylesheet" type="text/css" href="css/rules.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/roundSlider/1.3.2/roundslider.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/roundSlider/1.3.2/roundslider.min.js"></script>

</head>

<body style="margin: 0; padding: 0; background-color: #f9f9f7;">
 <table id="table" border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
  <tr>
   <td id="title" style="padding: 20px 0 30px 0; text-align: center;">
     <a class=title>The Carroll Project</a>
   </td>
  </tr>

  <tr>
   <td id="heading" style="padding: 0 0 0 0; text-align: center;"  align="center">
      <h2 style="font-family: Arial, Helvetica, sans-serif;">Choisis tes thèmes !</h2>
   </td>
 </tr>

 <tr>
  <td style="padding-left: 40px; text-align: left;">
    <p id="phrase" class=phrase>
    </p>
  </td>
 </tr>

 <tr>
  <td id="ctnAnswer" style="padding: 0 0 30px calc(50% - 60px); text-align: center;">
    <div id="btnAnswer" class="center-wrap" style="text-align: center;">
    </div></div>
  </td>
 </tr>

 <tr>
  <td id="categories" style="text-align: center;">
    <div align=center>
      <table border="0" cellpadding="0" cellspacing="0" width="500" height="100%"  margin= auto>
        <tr>
          <td style="text-align: left; padding-right: 20px; width: 50%">
            <label class="container">Indiquer une quantité
              <input id="ck1" type="checkbox">
              <span class="checkmark"></span>
            </label>
          </td>

          <td style="text-align: left; padding-left: 20px; width: 50%">
            <label class="container">Les nationalités
              <input id="ck2" type="checkbox">
              <span class="checkmark"></span>
            </label>
          </td>
        </tr>

        <tr>
          <td style="text-align: left; padding-right: 20px; width: 50%">
            <label class="container">Le preterit
              <input id="ck3" type="checkbox">
              <span class="checkmark"></span>
            </label>
          </td>

          <td style="text-align: left; padding-left: 20px; width: 50%">
            <label class="container">Le conditionnel
              <input id="ck4" type="checkbox">
              <span class="checkmark"></span>
            </label>
          </td>
        </tr>

        <tr>
          <td style="text-align: left; padding-right: 20px; width: 50%">
            <label class="container">Le passif
              <input id="ck5" type="checkbox">
              <span class="checkmark"></span>
            </label>
          </td>

          <td style="text-align: left; padding-left: 20px; width: 50%">
            <label class="container">Les prépositions
              <input id="ck6" type="checkbox">
              <span class="checkmark"></span>
            </label>
          </td>
        </tr>
      </table>
    </div>
   </td>
  </tr>

  <tr>
    <td id="btnStart" style="padding-top: 10px; padding-bottom: 0px;">
      <div class="center-wrap" align=center>
      <a>
       <div class="button" style="cursor: pointer; max-width: 170px" onclick=start()>
         C'est parti !
       <div class="mask"></div></a>
      </div></div>
    </td>
  </tr>

  <tr>
   <td id="regle" style="padding: 0 25px 0 25px; text-align: left;">
   </td>
  </tr>

  <tr>
    <td id="scores" align=center>
    </td>
  </tr>
</table>



  <script type="text/javascript">
  sentences = [
    /* Indiquer une quantité */
    [
      "<a class=wrong onclick=wrong(this)>Are there</a><a class=right id='right' onclick=rightA(this)> some </a><a class=wrong onclick=wrong(this)>vegetables left?</a>",
      "<a class=wrong onclick=wrong(this)>I have some homework to do for tomorrow.</a>",
      "<a class=wrong onclick=wrong(this)>Can I have</a><a class=right id='right' onclick=rightA(this)> many </a><a class=wrong onclick=wrong(this)>wine, please?</a>",
      "<a class=wrong onclick=wrong(this)>There are</a><a class=right id='right' onclick=rightA(this)> much </a><a class=wrong onclick=wrong(this)>people in the cinema.</a>",
      "<a class=wrong onclick=wrong(this)>Don't eat so</a><a class=right id='right' onclick=rightA(this)> many </a><a class=wrong onclick=wrong(this)>sugar.</a>",
      "<a class=wrong onclick=wrong(this)>Is there any cake left ?</a>",
      "<a class=wrong onclick=wrong(this)>There is</a><a class=right id='right' onclick=rightA(this)> any </a><a class=wrong onclick=wrong(this)>traffic.</a>",
      "<a class=wrong onclick=wrong(this)>There are</a><a class=right id='right' onclick=rightA(this)> much </a><a class=wrong onclick=wrong(this)>bikes outside the house.</a>",
      "<a class=wrong onclick=wrong(this)>I'd love yo have some days off.</a>",
      "<a class=wrong onclick=wrong(this)>Could I have some Jägerbomb, please?</a>"
    ],
    /* Les nationalités */
    [
      "<a class=wrong onclick=wrong(this)>During the 8th-11th centuries the Danes were known as Vikings.</a>",
      "<a class=right id='right' onclick=rightA(this)>The Spanish </a><a class=wrong onclick=wrong(this)>sometimes like bullfighting.</a>",
      "<a class=right id='right' onclick=rightA(this)>Australians </a><a class=wrong onclick=wrong(this)>kangaroos are the best known animals of the continent.</a>",
      "<a class=wrong onclick=wrong(this)>Most of the</a><a class=right id='right' onclick=rightA(this)> Swedish </a><a class=wrong onclick=wrong(this)>I know have blue eyes.</a>",
      "<a class=wrong onclick=wrong(this)>He lives in Tokyo. He is a Japanese.</a>",
      "<a class=wrong onclick=wrong(this)>She lives in Paris now but she is a</a><a class=right id='right' onclick=rightA(this)> vietnamese.</a>",
      "<a class=wrong onclick=wrong(this)>Everyone who comes from Europe is</a><a class=right id='right' onclick=rightA(this)> Europian.</a>",
      "<a class=wrong onclick=wrong(this)>As an</a><a class=right id='right' onclick=rightA(this)> English, </a><a class=wrong onclick=wrong(this)>I find it absolutely incredible that people would eat their horses.</a>",
      "<a class=wrong onclick=wrong(this)>Sorry I don't speak</a><a class=right id='right' onclick=rightA(this)> American.</a>",
      "<a class=wrong onclick=wrong(this)>Are people who live in Great Britain</a><a class=right id='right' onclick=rightA(this)> Great Britainer?</a>"
    ],
    /* Le preterit */
    [
      "<a class=right id='right' onclick=rightA(this)>Do </a><a class=wrong onclick=wrong(this)>you go to London yesterday?</a>",
      "<a class=wrong onclick=wrong(this)>I</a><a class=right id='right' onclick=rightA(this)> meet </a>old friends there.</a>",
      "<a class=wrong onclick=wrong(this)>They were all very happy to see me.</a>",
      "<a class=wrong onclick=wrong(this)>I even</a><a class=right id='right' onclick=rightA(this)> seen </a><a class=wrong onclick=wrong(this)>Prince Charles!</a>",
      "<a class=wrong onclick=wrong(this)>It was a wonderful journey yesterday!</a>",
      "<a class=wrong onclick=wrong(this)>I didn't play football last saturday.</a>",
      "<a class=wrong onclick=wrong(this)>Did he</a><a class=right id='right' onclick=rightA(this)> dieded?</a>",
      "<a class=wrong onclick=wrong(this)>I</a><a class=right id='right' onclick=rightA(this)> knowed </a><a class=wrong onclick=wrong(this)>you were my soulmate at first sight.</a>",
      "<a class=wrong onclick=wrong(this)>He lived in London when he was a child.</a>",
      "<a class=wrong onclick=wrong(this)>When I was a child, I</a><a class=right id='right' onclick=rightA(this)> go </a><a class=wrong onclick=wrong(this)>to Disneyland every summer.</a>"
    ],
    /* Le conditionnel */
    [
      "<a class=wrong onclick=wrong(this)>If I had the time, I would do my homework.</a>",
      "<a class=wrong onclick=wrong(this)>If you told me the truth, I would believe you.</a>",
      "<a class=wrong onclick=wrong(this)>If I</a><a class=right id='right' onclick=rightA(this)> was </a><a class=wrong onclick=wrong(this)>rich, I would buy a big house.</a>",
      "<a class=wrong onclick=wrong(this)>She said she would not like to come.</a>",
      "<a class=wrong onclick=wrong(this)>I</a><a class=right id='right' onclick=rightA(this)> could </a><a class=wrong onclick=wrong(this)>give you a big ring if I could</a>",
      "<a class=wrong onclick=wrong(this)>If I passed my exam, I</a><a class=right id='right' onclick=rightA(this)> will </a><a class=wrong onclick=wrong(this)>maybe work in a kindergarten.</a>",
      "<a class=wrong onclick=wrong(this)>Ok, well, if I spoke English fluently, I could maybe work in an English firm and make a lot of money!</a>",
      "<a class=wrong onclick=wrong(this)>If she lived in the city, she</a><a class=right id='right' onclick=rightA(this)> will </a><a class=wrong onclick=wrong(this)>have better job opportunities</a>",
      "<a class=wrong onclick=wrong(this)>If I were on holiday, I would relax and sleep a lot.</a>",
      "<a class=wrong onclick=wrong(this)>If they had invited him, he would have</a><a class=right id='right' onclick=rightA(this)> will </a><a class=wrong onclick=wrong(this)>come.</a>"
    ],
    /* Le passif */
    [
      "<a class=wrong onclick=wrong(this)>The murderer has not</a><a class=right id='right' onclick=rightA(this)> been </a><a class=wrong onclick=wrong(this)>caught yet</a>",
      "<a class=wrong onclick=wrong(this)>The accident was</a><a class=right id='right' onclick=rightA(this)> cause </a><a class=wrong onclick=wrong(this)>by the fog.</a>",
      "<a class=wrong onclick=wrong(this)>The luggage will be carried upstairs.</a>",
      "<a class=wrong onclick=wrong(this)>Everyday the cat is</a><a class=right id='right' onclick=rightA(this)> feeding </a><a class=wrong onclick=wrong(this)>by John</a>",
      "<a class=wrong onclick=wrong(this)>The house was built in two months</a>",
      "<a class=wrong onclick=wrong(this)>English is spoken in a lot of countries.</a>",
      "<a class=wrong onclick=wrong(this)>The bridge was built</a><a class=right id='right' onclick=rightA(this)> at </a><a class=wrong onclick=wrong(this)>the Romans.</a>",
      "<a class=wrong onclick=wrong(this)That novel was written by Lewis Carroll.</a>",
      "<a class=wrong onclick=wrong(this)>After the incident a new car had to be bought</a><a class=right id='right' onclick=rightA(this)> by.</a>",
      "<a class=wrong onclick=wrong(this)>He is told a story.</a>"
    ],
    /* Les prépositions */
    [
      "<a class=wrong onclick=wrong(this)>Yesterday, I was in New York: I come</a><a class=right id='right' onclick=rightA(this)> of </a><a class=wrong onclick=wrong(this)>New York.</a>",
      "<a class=wrong onclick=wrong(this)>My parents gave this record to my sister.</a>",
      "<a class=wrong onclick=wrong(this)>I'll move</a><a class=right id='right' onclick=rightA(this)> in </a><a class=wrong onclick=wrong(this)>Italy next year.</a>",
      "<a class=wrong onclick=wrong(this)>I live</a><a class=right id='right' onclick=rightA(this)> at </a><a class=wrong onclick=wrong(this)>Paris.</a>",
      "<a class=wrong onclick=wrong(this)>I think I'll arrive at eight pm</a><a class=right id='right' onclick=rightA(this)> of </a><a class=wrong onclick=wrong(this)>April, 25th.</a>",
      "<a class=wrong onclick=wrong(this)>He puts his laptop into his suitcase.</a>",
      "<a class=wrong onclick=wrong(this)>Some pupils go to school</a><a class=right id='right' onclick=rightA(this)> by </a><a class=wrong onclick=wrong(this)>bus.</a>",
      "<a class=wrong onclick=wrong(this)>There is a nice garden around our house.</a>",
      "<a class=wrong onclick=wrong(this)>I live in a house near</a><a class=right id='right' onclick=rightA(this)> at </a><a class=wrong onclick=wrong(this)>the school.</a>",
      "<a class=wrong onclick=wrong(this)>Jeremy always talks</a><a class=right id='right' onclick=rightA(this)> of </a><a class=wrong onclick=wrong(this)>so many things !</a>"
    ]
  ]

    clicked = false;
    nextTheme = -1;
    scores = new Array(1);
    right = new Array(6);
    total = new Array(6);
    nbThemes = 0;
    themesChoisis = new Array(1);
    exNumQstn = -1;
    numQstn = -1;

    function start() {
      themes = [0, 0, 0, 0, 0, 0];
      for (var i=0; i<6; i++) {
        if (document.getElementById("ck"+(i+1).toString()).checked) {
          themes[i] = 1;
        }
      }

      nbThemes = themes[0]+themes[1]+themes[2]+themes[3]+themes[4]+themes[5];
      if (nbThemes > 0) {
        /* On efface les données et on remplace par la question */
        document.getElementById("categories").innerHTML="";
        document.getElementById("btnStart").innerHTML="";

        clicked = false;

        /* On crée les différents tableaux nécessaires */
        themesChoisis = new Array(nbThemes);
        var cnt = 0;
        for (i=0; i<6; i++) {
          if (themes[i] == 1) {
            themesChoisis[cnt] = i;
            cnt++;
          }
          right[i] = 0;
          total[i] = 0;
        }

        scores = new Array(nbThemes);
        for (i=0; i<nbThemes; i++) {
          scores[i] = 0;
        }

        /* On passe au début du test */
        nextSentence();
      }
    }

    function nextSentence() {
      //Is it the end of the test ?
      scoreTotal = 0;
      for (i=0; i<nbThemes; i++) {
        scoreTotal += scores[i];
      }
      if (scoreTotal == 3*nbThemes) {
        displayScores();
      }
      else {
        clicked = false;

        rand = Math.floor(Math.random() * nbThemes);
        while(scores[rand]==3) {
          rand = Math.floor(Math.random() * nbThemes);
        }
        nextTheme = themesChoisis[rand];
        exNumQstn = numQstn;
        numQstn = Math.floor(Math.random() * 10);
        while(exNumQstn == numQstn) {
          numQstn = Math.floor(Math.random() * 10);
        }
        nextQuestion = sentences[nextTheme][numQstn];

        /* On affiche les différents éléments */
        explications = "<p class=heading>Clique sur la faute, ou sur le bouton 'Correct' si tu penses qu'il n'y en a pas.</p>";
        heading = document.getElementById("heading");
        heading.innerHTML = explications;
        heading.style = "background-color: none";
        document.getElementById("phrase").innerHTML = "<b>"+nextQuestion+"</b>";
        btnAnswerTxt = "<a><div id='txtBtn' class='button' style='cursor: pointer;' onclick=check(this)>Correct<div class='mask'></div></a>"
        document.getElementById("btnAnswer").innerHTML = btnAnswerTxt;
        document.getElementById("regle").innerHTML = "";
      }
    }

    function displayScores() {
      heading = document.getElementById("heading");
      heading.innerHTML = "";
      heading.style = "background-color: none";
      document.getElementById("phrase").innerHTML = "";
      document.getElementById("btnAnswer").innerHTML = "";
      document.getElementById("regle").innerHTML = "";

      document.getElementById("table").deleteRow(5);
      document.getElementById("table").deleteRow(4);
      document.getElementById("table").deleteRow(3);
      document.getElementById("table").deleteRow(3);
      document.getElementById("table").deleteRow(1);

      document.getElementById("title").style = "padding-bottom: 0; text-align: center;";

      tabScores = document.getElementById("scores");

      htmlScores = "<table class='scores'>\
                      <tr>\
                        <td align=center style='padding-right: 20px;'><p style='font-family: Arial, Helvetica, sans-serif; font-size: 18px;'>Indiquer une quantité</p></td>\
                        <td align=center style='padding-right: 20px;'><p style='font-family: Arial, Helvetica, sans-serif; font-size: 18px;'>Les nationalités</p></td>\
                        <td align=center><p style='font-family: Arial, Helvetica, sans-serif; font-size: 18px;'>Le preterit</p></td>\
                        </tr>\
                      <tr>\
                        <td align=center style='padding-right: 20px;'><div id=\"slider1\"></div></td>\
                        <td align=center style='padding-right: 20px;'><div id=\"slider2\"></div></td>\
                        <td align=center><div id=\"slider3\"></div></td>\
                      </tr>\
                      <tr>\
                        <td align=center style='padding-right: 20px;'><p style='font-family: Arial, Helvetica, sans-serif; font-size: 18px;'>Le conditionnel</p></td>\
                        <td align=center style='padding-right: 20px;'><p style='font-family: Arial, Helvetica, sans-serif; font-size: 18px;'>Le passif</p></td>\
                        <td align=center><p style='font-family: Arial, Helvetica, sans-serif; font-size: 18px;'>Les prépositions</p></td>\
                      </tr>\
                      <tr>\
                        <td align=center style='padding-right: 20px;'><div id=\"slider4\"></div></td>\
                        <td align=center style='padding-right: 20px;'><div id=\"slider5\"></div></td>\
                        <td align=center><div id=\"slider6\"></div></td>\
                      </tr>\
                    </table>";
      tabScores.innerHTML = htmlScores;

      $("#slider1").roundSlider({
          min: 0,
          max: total[0],
          step: 1,
          value: right[0],
          sliderType: "min-range"
      });

      $("#slider2").roundSlider({
          min: 0,
          max: total[1],
          step: 1,
          value: right[1],
          sliderType: "min-range"
      });

      $("#slider3").roundSlider({
          min: 0,
          max: total[2],
          step: 1,
          value: right[2],
          sliderType: "min-range"
      });

      $("#slider4").roundSlider({
          min: 0,
          max: total[3],
          step: 1,
          value: right[3],
          sliderType: "min-range"
      });

      $("#slider5").roundSlider({
          min: 0,
          max: total[4],
          step: 1,
          value: right[4],
          sliderType: "min-range"
      });

      $("#slider6").roundSlider({
          min: 0,
          max: total[5],
          step: 1,
          value: right[5],
          sliderType: "min-range"
      });
    }

      //Wrong answer
      //***************** BEGIN FUNCTION wrong *************************
      function wrong(answer) {
        if (!clicked) {
          if (!document.getElementById("right")) {
          }
          else {
            document.getElementById("right").style = "background-color: #ffff66;";
          }
          heading = document.getElementById("heading");
          heading.style = "background-color: #ff6721; text-align: center;";
          heading.innerHTML = "<p class=hWrong>MAUVAISE REPONSE</p>";
          clicked = true;
          document.getElementById("txtBtn").innerHTML = "Suivant";
          fichier = nextTheme.toString()+".html";
          document.getElementById("regle").innerHTML = "<iframe style='width: 100%; height: 400px;' src='rules/"+fichier+"' frameborder='0'></iframe>";

          /* On update les scores */
          th = 0;
          while (themesChoisis[th] != nextTheme) {
            th++;
          }
          total[nextTheme]++;
          scores[th] = 0;
        }
      }
      //***************** END FUNCTION wrong ***************************

      //Right answer
      //***************** BEGIN FUNCTION right **************************
      function rightA(answer) {
        if (!clicked) {
          answer.style = "background-color: #ffff66;";
          heading = document.getElementById("heading");
          heading.style = "background-color: #08af00; text-align: center;";
          heading.innerHTML = "<p class=hRight>BONNE REPONSE</p>";
          clicked = true;
          document.getElementById("txtBtn").innerHTML = "Suivant";
          fichier = nextTheme.toString()+".html";
          document.getElementById("regle").innerHTML = "<iframe style='width: 100%; height: 400px;' src='rules/"+fichier+"' frameborder='0'></iframe>";

          /* On update les scores */
          th = 0;
          while (themesChoisis[th] != nextTheme) {
            th++;
          }
          total[nextTheme]++;
          scores[th]++;
          right[nextTheme]++;
        }
      }
      //***************** END FUNCTION right ****************************

      //Check answer
      //***************** BEGIN FUNCTION check **************************
      function check(btn) {
        if (!clicked) {
          if (!document.getElementById("right")) {
            heading = document.getElementById("heading");
            heading.style = "background-color: #08af00; text-align: center";
            heading.innerHTML = "<p class=hRight>BONNE REPONSE</p>";

            /* On update les scores */
            th = 0;
            while (themesChoisis[th] != nextTheme) {
              th++;
            }
            total[nextTheme]++;
            scores[th]++;
            right[nextTheme]++;
          }
          else {
            document.getElementById("right").style = "background-color: #ffff66;";
            heading = document.getElementById("heading");
            heading.style = "background-color: #ff6721; text-align: center";
            heading.innerHTML = "<p class=hWrong>MAUVAISE REPONSE</p>";

            /* On update les scores */
            th = 0;
            while (themesChoisis[th] != nextTheme) {
              th++;
            }
            total[nextTheme]++;
            scores[th] = 0;
          }
          btn.innerHTML = "Suivant";
          clicked = true;
          fichier = nextTheme.toString()+".html";
          document.getElementById("regle").innerHTML = "<iframe style='width: 100%; height: 400px;' src='rules/"+fichier+"' frameborder='0'></iframe>";
        }
        else {
          nextSentence();
        }
      }
  </script>

</body>
</html>
