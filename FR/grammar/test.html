<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>The Carroll Project</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" type="text/css" href="css/test.css">
  <link rel="stylesheet" type="text/css" href="css/buttons.css">
  <link rel="stylesheet" type="text/css" href="css/checkbox.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/roundSlider/1.3.2/roundslider.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/roundSlider/1.3.2/roundslider.min.js"></script>

</head>

<body style="margin: 0; padding: 0; background-color: #f9f9f7;">
 <table id="table" border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
  <tr>
   <td id="title" style="padding: 20px 0 30px 0; text-align: center;">
     <a class=title href='carroll-project.html'>The Carroll Project</a>
   </td>
  </tr>

  <tr>
   <td id="heading" style="padding: 0 0 0 0; text-align: center;"  align="center">
      <h2 style="font-family: Arial, Helvetica, sans-serif;">Choisis tes thèmes !</h2>
   </td>
 </tr>

 <tr>
  <td style="padding-left: 40px; text-align: left;">
    <p id="phrase" class=phrase>
    </p>
  </td>
 </tr>

 <tr>
  <td id="ctnAnswer" style="padding: 0 0 30px calc(50% - 60px); text-align: center;">
    <div id="btnAnswer" class="center-wrap" style="text-align: center;">
    </div></div>
  </td>
 </tr>

 <tr>
  <td id="categories" style="text-align: center;">
    <div align=center>
      <table border="0" cellpadding="0" cellspacing="0" width="500" height="100%"  margin= auto>
        <tr>
          <td style="text-align: left; padding-right: 20px; width: 50%">
            <label class="container">Indiquer une quantité
              <input id="ck1" type="checkbox">
              <span class="checkmark"></span>
            </label>
          </td>

          <td style="text-align: left; padding-left: 20px; width: 50%">
            <label class="container">Les nationalités
              <input id="ck2" type="checkbox">
              <span class="checkmark"></span>
            </label>
          </td>
        </tr>

        <tr>
          <td style="text-align: left; padding-right: 20px; width: 50%">
            <label class="container">Le preterit
              <input id="ck3" type="checkbox">
              <span class="checkmark"></span>
            </label>
          </td>

          <td style="text-align: left; padding-left: 20px; width: 50%">
            <label class="container">Le conditionnel
              <input id="ck4" type="checkbox">
              <span class="checkmark"></span>
            </label>
          </td>
        </tr>

        <tr>
          <td style="text-align: left; padding-right: 20px; width: 50%">
            <label class="container">Le passif
              <input id="ck5" type="checkbox">
              <span class="checkmark"></span>
            </label>
          </td>

          <td style="text-align: left; padding-left: 20px; width: 50%">
            <label class="container">Les prépositions
              <input id="ck6" type="checkbox">
              <span class="checkmark"></span>
            </label>
          </td>
        </tr>
      </table>
    </div>
   </td>
  </tr>

  <tr>
    <td id="btnStart" style="padding-top: 10px">
      <div class="center-wrap" align=center>
      <a>
       <div class="button" style="cursor: pointer; max-width: 170px" onclick=start()>
         C'est parti !
       <div class="mask"></div></a>
      </div></div>
    </td>
  </tr>

  <tr>
   <td id="regle" style="padding: 10px 0 30px 40px; text-align: left;">
   </td>
  </tr>

  <tr>
    <td id="scores" align=center>
    </td>
  </tr>
</table>



  <script type="text/javascript">
    sentences = [
      /* Indiquer une quantité */
      [
        "<a class=wrong onclick=wrong(this)>1-1</a>",
        "<a class=wrong onclick=wrong(this)>1-2</a>",
        "<a class=wrong onclick=wrong(this)>1-3</a>",
        "<a class=wrong onclick=wrong(this)>1-4</a>",
        "<a class=wrong onclick=wrong(this)>1-5</a>",
        "<a class=wrong onclick=wrong(this)>1-6</a>",
        "<a class=wrong onclick=wrong(this)>1-7</a>",
        "<a class=wrong onclick=wrong(this)>1-8</a>",
        "<a class=wrong onclick=wrong(this)>1-9</a>",
        "<a class=wrong onclick=wrong(this)>1-10</a>"
      ],
      /* Les nationalités */
      [
        "<a class=wrong onclick=wrong(this)>2-1</a>",
        "<a class=wrong onclick=wrong(this)>2-2</a>",
        "<a class=wrong onclick=wrong(this)>2-3</a>",
        "<a class=wrong onclick=wrong(this)>2-4</a>",
        "<a class=wrong onclick=wrong(this)>2-5</a>",
        "<a class=wrong onclick=wrong(this)>2-6</a>",
        "<a class=wrong onclick=wrong(this)>2-7</a>",
        "<a class=wrong onclick=wrong(this)>2-8</a>",
        "<a class=wrong onclick=wrong(this)>2-9</a>",
        "<a class=wrong onclick=wrong(this)>2-10</a>"
      ],
      /* Le preterit */
      [
        "<a class=wrong onclick=wrong(this)>3-1</a>",
        "<a class=wrong onclick=wrong(this)>3-2</a>",
        "<a class=wrong onclick=wrong(this)>3-3</a>",
        "<a class=wrong onclick=wrong(this)>3-4</a>",
        "<a class=wrong onclick=wrong(this)>3-5</a>",
        "<a class=wrong onclick=wrong(this)>3-6</a>",
        "<a class=wrong onclick=wrong(this)>3-7</a>",
        "<a class=wrong onclick=wrong(this)>3-8</a>",
        "<a class=wrong onclick=wrong(this)>3-9</a>",
        "<a class=wrong onclick=wrong(this)>3-10</a>"
      ],
      /* Le conditionnel */
      [
        "<a class=wrong onclick=wrong(this)>4-1</a>",
        "<a class=wrong onclick=wrong(this)>4-2</a>",
        "<a class=wrong onclick=wrong(this)>4-3</a>",
        "<a class=wrong onclick=wrong(this)>4-4</a>",
        "<a class=wrong onclick=wrong(this)>4-5</a>",
        "<a class=wrong onclick=wrong(this)>4-6</a>",
        "<a class=wrong onclick=wrong(this)>4-7</a>",
        "<a class=wrong onclick=wrong(this)>4-8</a>",
        "<a class=wrong onclick=wrong(this)>4-9</a>",
        "<a class=wrong onclick=wrong(this)>4-10</a>"
      ],
      /* Le passif */
      [
        "<a class=wrong onclick=wrong(this)>5-1</a>",
        "<a class=wrong onclick=wrong(this)>5-2</a>",
        "<a class=wrong onclick=wrong(this)>5-3</a>",
        "<a class=wrong onclick=wrong(this)>5-4</a>",
        "<a class=wrong onclick=wrong(this)>5-5</a>",
        "<a class=wrong onclick=wrong(this)>5-6</a>",
        "<a class=wrong onclick=wrong(this)>5-7</a>",
        "<a class=wrong onclick=wrong(this)>5-8</a>",
        "<a class=wrong onclick=wrong(this)>5-9</a>",
        "<a class=wrong onclick=wrong(this)>5-10</a>"
      ],
      /* Les prépositions */
      [
        "<a class=wrong onclick=wrong(this)>6-1</a>",
        "<a class=wrong onclick=wrong(this)>6-2</a>",
        "<a class=wrong onclick=wrong(this)>6-3</a>",
        "<a class=wrong onclick=wrong(this)>6-4</a>",
        "<a class=wrong onclick=wrong(this)>6-5</a>",
        "<a class=wrong onclick=wrong(this)>6-6</a>",
        "<a class=wrong onclick=wrong(this)>6-7</a>",
        "<a class=wrong onclick=wrong(this)>6-8</a>",
        "<a class=wrong onclick=wrong(this)>6-9</a>",
        "<a class=wrong onclick=wrong(this)>6-10</a>"
      ]
    ]

    clicked = false;
    nextTheme = -1;
    scores = new Array(1);
    right = new Array(6);
    total = new Array(6);
    nbThemes = 0;
    themesChoisis = new Array(1);
    exNumQstn = -1;
    numQstn = -1;

    function start() {
      themes = [0, 0, 0, 0, 0, 0];
      for (var i=0; i<6; i++) {
        if (document.getElementById("ck"+(i+1).toString()).checked) {
          themes[i] = 1;
        }
      }

      nbThemes = themes[0]+themes[1]+themes[2]+themes[3]+themes[4]+themes[5];
      if (nbThemes > 0) {
        /* On efface les données et on remplace par la question */
        document.getElementById("categories").innerHTML="";
        document.getElementById("btnStart").innerHTML="";

        clicked = false;

        /* On crée les différents tableaux nécessaires */
        themesChoisis = new Array(nbThemes);
        var cnt = 0;
        for (i=0; i<6; i++) {
          if (themes[i] == 1) {
            themesChoisis[cnt] = i;
            cnt++;
          }
          right[i] = 0;
          total[i] = 0;
        }

        scores = new Array(nbThemes);
        for (i=0; i<nbThemes; i++) {
          scores[i] = 0;
        }

        /* On passe au début du test */
        nextSentence();
      }
    }

    function nextSentence() {
      //Is it the end of the test ?
      scoreTotal = 0;
      for (i=0; i<nbThemes; i++) {
        scoreTotal += scores[i];
      }
      if (scoreTotal == 3*nbThemes) {
        displayScores();
      }
      else {
        clicked = false;

        rand = Math.floor(Math.random() * nbThemes);
        while(scores[rand]==3) {
          rand = Math.floor(Math.random() * nbThemes);
        }
        nextTheme = themesChoisis[rand];
        exNumQstn = numQstn;
        numQstn = Math.floor(Math.random() * 10);
        while(exNumQstn == numQstn) {
          numQstn = Math.floor(Math.random() * 10);
        }
        nextQuestion = sentences[nextTheme][numQstn];

        /* On affiche les différents éléments */
        explications = "<p class=heading>Clique sur la faute, ou sur le bouton 'Correct' si tu penses qu'il n'y en a pas.</p>";
        heading = document.getElementById("heading");
        heading.innerHTML = explications;
        heading.style = "background-color: none";
        document.getElementById("phrase").innerHTML = nextQuestion;
        btnAnswerTxt = "<a><div id='txtBtn' class='button' style='cursor: pointer;' onclick=check(this)>Correct<div class='mask'></div></a>"
        document.getElementById("btnAnswer").innerHTML = btnAnswerTxt;
        document.getElementById("regle").innerHTML = "";
      }
    }

    function displayScores() {
      heading = document.getElementById("heading");
      heading.innerHTML = "";
      heading.style = "background-color: none";
      document.getElementById("phrase").innerHTML = "";
      document.getElementById("btnAnswer").innerHTML = "";
      document.getElementById("regle").innerHTML = "";

      document.getElementById("table").deleteRow(5);
      document.getElementById("table").deleteRow(4);
      document.getElementById("table").deleteRow(3);
      document.getElementById("table").deleteRow(3);
      document.getElementById("table").deleteRow(1);

      document.getElementById("title").style = "padding-bottom: 0; text-align: center;";

      tabScores = document.getElementById("scores");

      htmlScores = "<table class='scores'>\
                      <tr>\
                        <td align=center style='padding-right: 20px;'><p style='font-family: Arial, Helvetica, sans-serif; font-size: 20px;'>Indiquer une quantité</p></td>\
                        <td align=center style='padding-right: 20px;'><p style='font-family: Arial, Helvetica, sans-serif; font-size: 20px;'>Les nationalités</p></td>\
                        <td align=center><p style='font-family: Arial, Helvetica, sans-serif; font-size: 20px;'>Le preterit</p></td>\
                        </tr>\
                      <tr>\
                        <td align=center style='padding-right: 20px;'><div id=\"slider1\"></div></td>\
                        <td align=center style='padding-right: 20px;'><div id=\"slider2\"></div></td>\
                        <td align=center><div id=\"slider3\"></div></td>\
                      </tr>\
                      <tr>\
                        <td align=center style='padding-right: 20px;'><p style='font-family: Arial, Helvetica, sans-serif; font-size: 20px;'>Le conditionnel</p></td>\
                        <td align=center style='padding-right: 20px;'><p style='font-family: Arial, Helvetica, sans-serif; font-size: 20px;'>Le passif</p></td>\
                        <td align=center><p style='font-family: Arial, Helvetica, sans-serif; font-size: 20px;'>Les prépositions</p></td>\
                      </tr>\
                      <tr>\
                        <td align=center style='padding-right: 20px;'><div id=\"slider4\"></div></td>\
                        <td align=center style='padding-right: 20px;'><div id=\"slider5\"></div></td>\
                        <td align=center><div id=\"slider6\"></div></td>\
                      </tr>\
                    </table>";
      tabScores.innerHTML = htmlScores;

      $("#slider1").roundSlider({
          min: 0,
          max: total[0],
          step: 1,
          value: right[0],
          sliderType: "min-range"
      });

      $("#slider2").roundSlider({
          min: 0,
          max: total[1],
          step: 1,
          value: right[1],
          sliderType: "min-range"
      });

      $("#slider3").roundSlider({
          min: 0,
          max: total[2],
          step: 1,
          value: right[2],
          sliderType: "min-range"
      });

      $("#slider4").roundSlider({
          min: 0,
          max: total[3],
          step: 1,
          value: right[3],
          sliderType: "min-range"
      });

      $("#slider5").roundSlider({
          min: 0,
          max: total[4],
          step: 1,
          value: right[4],
          sliderType: "min-range"
      });

      $("#slider6").roundSlider({
          min: 0,
          max: total[5],
          step: 1,
          value: right[5],
          sliderType: "min-range"
      });
    }

      //Wrong answer
      //***************** BEGIN FUNCTION wrong *************************
      function wrong(answer) {
        if (!clicked) {
          if (!document.getElementById("right")) {
          }
          else {
            document.getElementById("right").style = "background-color: #ffff66;";
          }
          heading = document.getElementById("heading");
          heading.style = "background-color: #ff6721; text-align: center;";
          heading.innerHTML = "<p class=hWrong>MAUVAISE REPONSE</p>";
          clicked = true;
          document.getElementById("txtBtn").innerHTML = "Suivant";
          fichier = nextTheme.toString()+".html";
          document.getElementById("regle").innerHTML = "<iframe src='rules/"+fichier+"' frameborder='0'></iframe>";

          /* On update les scores */
          th = 0;
          while (themesChoisis[th] != nextTheme) {
            th++;
          }
          total[nextTheme]++;
          scores[th] = 0;
        }
      }
      //***************** END FUNCTION wrong ***************************

      //Right answer
      //***************** BEGIN FUNCTION right **************************
      function right(answer) {
        if (!clicked) {
          answer.style = "background-color: #ffff66;";
          heading = document.getElementById("heading");
          heading.style = "background-color: #08af00; text-align: center;";
          heading.innerHTML = "<p class=hRight>BONNE REPONSE</p>";
          clicked = true;
          document.getElementById("txtBtn").innerHTML = "Suivant";
          fichier = nextTheme.toString()+".html";
          document.getElementById("regle").innerHTML = "<iframe src='rules/"+fichier+"' frameborder='0'></iframe>";

          /* On update les scores */
          th = 0;
          while (themesChoisis[th] != nextTheme) {
            th++;
          }
          total[nextTheme]++;
          scores[th]++;
          right[nextTheme]++;
        }
      }
      //***************** END FUNCTION right ****************************

      //Check answer
      //***************** BEGIN FUNCTION check **************************
      function check(btn) {
        if (!clicked) {
          if (!document.getElementById("right")) {
            heading = document.getElementById("heading");
            heading.style = "background-color: #08af00; text-align: center";
            heading.innerHTML = "<p class=hRight>BONNE REPONSE</p>";

            /* On update les scores */
            th = 0;
            while (themesChoisis[th] != nextTheme) {
              th++;
            }
            total[nextTheme]++;
            scores[th]++;
            right[nextTheme]++;
          }
          else {
            document.getElementById("right").style = "background-color: #ffff66;";
            heading = document.getElementById("heading");
            heading.style = "background-color: #ff6721; text-align: center";
            heading.innerHTML = "<p class=hWrong>MAUVAISE REPONSE</p>";

            /* On update les scores */
            th = 0;
            while (themesChoisis[th] != nextTheme) {
              th++;
            }
            total[nextTheme]++;
            scores[th] = 0;
          }
          btn.innerHTML = "Suivant";
          clicked = true;
          fichier = nextTheme.toString()+".html";
          document.getElementById("regle").innerHTML = "<iframe src='rules/"+fichier+"' frameborder='0'></iframe>";
        }
        else {
          nextSentence();
        }
      }
  </script>

</body>
</html>
